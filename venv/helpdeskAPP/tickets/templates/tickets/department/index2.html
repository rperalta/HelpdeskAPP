{% extends "tickets/base.html" %}
{% load static %}

{% block title %}
  {% if department %}
    {{ department.department_name }}
  {% else %}
    Department
  {% endif %}
{% endblock %}

{% block content %}

<nav class="navbar navbar-dark bg-dark p-0 shadow">
  <a class="navbar-brand mx-auto" style="text-align:center;" href="{% url 'tickets:department_list' %}">Hilo Medical Center</a>

<!--  <input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">-->
  {% if user.is_authenticated %}
  <ul class="navbar-nav px-3">
    <li class="nav-item text-nowrap">
      <a class="nav-link" href="#">{{ user.username }}</a>
    </li>
  </ul>
  <ul class="navbar-nav px-3">
    <li class="nav-item text-nowrap">
      <a class="nav-link" href="{% url 'logout'%}?next=/accounts/login">Sign out</a>
    </li>
  </ul>
    {% else %}
    <ul class="navbar-nav px-3">
        <li class="nav-item text-nowrap">
            <a class="nav-link" href="{% url 'login'%}?next={{request.path}}">Sign in</a>
        </li>
    </ul>
    {% endif %}
</nav>

<section class="jumbotron text-center">
  <div class="container">
    <h1 class="jumbotron-heading">Welcome to helpdesk</h1>
    <p class="lead text-muted">How can we assist you {{ user }}?</p>
    <p>
      <a href="#" class="btn btn-primary my-2">Main call to action</a>
      <a href="#" class="btn btn-secondary my-2">Secondary action</a>
    </p>
  </div>
</section>

{% if user.is_authenticated %}
<div class="container-fluid">
  <div class="row">
      <div class="sidebar-sticky pt-3">
        {% if department %}
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link active" href="{% url 'tickets:my_ticket_list' department.slug department.id %}">
              <span data-feather="home"></span>
              View Tickets <span class="sr-only">(current)</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{% url 'tickets:create_ticket' department.slug department.id %}">
              <span data-feather="file"></span>
              Submit a ticket
            </a>
          </li>
        </ul>
        {% endif %}
      </div>

    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
<!--      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">-->
<!--        <div class="btn-toolbar mb-2 mb-md-0">-->
<!--          <div class="btn-group mr-2">-->
<!--            <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>-->
<!--            <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>-->
<!--          </div>-->
<!--          <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">-->
<!--            <span data-feather="calendar"></span>-->
<!--            This week-->
<!--          </button>-->
<!--        </div>-->
<!--      </div>-->
      {% if department %}
      <h1>{{ department.department_name }}</h1>
      {% else %}
      <div class="album py-5 bg-light">
        <div class="container">

          <div class="row">
            {% for d in departments %}
            {% if department.slug == d.slug %} class="selected" {% endif %}
            <div class="col-md-4">
              <div class="card mb-4 box-shadow">
               <img src="{{ d.department_image.url }}">
                <div class="card-body align-self-center" style="text-align:center">
                  <p class="card-text">Place department description here.</p>
                  <div class="d-flex justify-content-between align-items-center">
                    <div class="btn-group">
                      <a href="{{ d.get_absolute_url }}" class="btn btn-primary">{{ d.department_name }} Home page</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
      {% endif %}

    </main>
  </div>
</div>
{% else %}
<h4>Please Sign in to continue</h4>
{% endif %}
{% endblock %}
